# Домашнее задание к занятию «1.3. Нереляционные базы данных - использование из Go»

Все задачи этого занятия нужно делать в **одном репозитории**.

В качестве результата пришлите ссылки на ваши GitHub-проекты через личный кабинет студента на сайте [netology.ru](https://netology.ru).

**Важно**: если у вас что-то не получилось, то оформляйте Issue [по установленным правилам](../report-requirements.md).

**ВАЖНО**: НИ В КОЕМ СЛУЧАЕ НЕ ПОДСТАВЛЯЙТЕ ДАННЫЕ СВОИХ РЕАЛЬНЫХ КАРТ В КОД! Это очень частая "оплошность": разработчики случайно коммитят и заливают на GitHub "чувствительные" (sensitive) данные (ключи, логины, пароли, адреса и т.д.). Используйте генераторы вроде: https://www.freeformatter.com/credit-card-number-generator-validator.html

Если вы всё же "случайно" залили чувствительные данные на GitHub, то используйте [инструкцию по удалению данных](https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository). Кроме того, как бы это печально ни было, рекомендуем вам заблокировать карту и заказать в банке новую.

## Как сдавать задачи

1. Создайте на вашем компьютере Go-модуль (см. доп.видео к первой лекции).
1. Добавьте в него в качестве зависимостей pgx v4.
1. Инициализируйте в нём пустой Git-репозиторий.
1. Добавьте в него готовый файл [.gitignore](../.gitignore).
1. Добавьте в этот же каталог остальные необходимые файлы (убедитесь, что они аккуратно разложены по пакетам).
1. Сделайте необходимые коммиты.
1. Создайте публичный репозиторий на GitHub и свяжите свой локальный репозиторий с удалённым.
1. Сделайте пуш (удостоверьтесь, что ваш код появился на GitHub).
1. Ссылку на ваш проект отправьте в личном кабинете на сайте [netology.ru](https://netology.ru).
1. Задачи, отмеченные как необязательные, можно не сдавать, это не повлияет на получение зачета (в этом ДЗ все задачи являются обязательными).

## PostgreSQL + MongoDB

### Легенда

<details>
<summary>Легенда</summary>

В прошлом ДЗ вы проектировали базу для хранения частых платежей и предсказаний.  

Пример того, как это выглядело:

![](../02_mongodb/pic/payments01.png)

![](../02_mongodb/pic/payments02.png)

А в позапрошлом вы реализовывали механизмы разграничения доступа.

Пришло время соединить их в одном приложении, которое будет взаимодействовать и с PostgreSQL, и с MongoDB.

</details>

### Задача

1. Создать пустой проект (или возьмите один из предыдущих).
1. Добавить `docker-compose.yml` для поднятия PostgreSQL и MongoDB (в этот раз названия сервисов должны быть разные, например, `clientsdb` и `suggestionsdb`).
1. Добавить файлы инициализации для БД.
1. Реализовать хранение пользователей и две роли: `USER`, `SERVICE` (всё это в PostgreSQL).
1. Реализовать следующее API:
    1. Пользователь может аутентифицироваться и просматривать список частых платежей и предсказаний (предназначенных для него).
    1. Service (это внешний сервис) может аутентифицироваться и добавлять с помощью вашего API в MongoDB предсказания для пользователей (указывая ID пользователя).
1. Приложить запросы (либо через Go `http.Client`, либо через автотесты, либо запросы в формате `requests.http`), демонстрирующие вызовы вашего API (**без них ДЗ будет отправлено на доработку**).

Реализовывать регистрацию и другие функции не нужно. Требуются только аутентификация, просмотр для пользователя и добавление/обновление для внешнего сервиса. 

Итого:
* в PostgreSQL хранятся пользователи (вместе с паролями)
* в MongoDB "предсказания" (документ вида: id пользователя + предсказания для него)

В качестве результата пришлите ссылку на ваш GitHub-проект, в котором реализованы описанные выше требования.

Строгих требований к оформлению нет, вы сами архитектор и разработчик. Но будьте готовы к критике выбранного подхода со стороны проверяющих и необходимости внесения изменений.
